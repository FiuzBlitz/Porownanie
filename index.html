<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Por√≥wnania ‚Äì Plusy i Minusy</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: 0.3s;
        }

        :root {
            --bg: #ffffff;
            --text: #000000;
            --card: #f2f2f2;
        }

        .dark {
            --bg: #121212;
            --text: #eaeaea;
            --card: #1f1f1f;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            font-size: 22px;
            background: var(--card);
        }

        .theme-btn {
            font-size: 28px;
            cursor: pointer;
        }

        .container { padding: 15px; }
        .hidden { display: none; }

        .comparison-card {
            background: var(--card);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: pointer;
        }

        .add-btn {
            position: fixed;
            right: 20px;
            bottom: 20px;
            background: #4caf50;
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 35px;
            border: none;
            cursor: pointer;
        }

        .section-title {
            font-size: 20px;
            margin-top: 20px;
        }

        .item-row {
            display: flex;
            justify-content: space-between;
            background: var(--card);
            padding: 10px;
            border-radius: 8px;
            margin-top: 8px;
        }

        .delete-btn {
            background: #d9534f;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
        }

        .score-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            padding: 8px;
            margin-top: 10px;
            border-radius: 5px;
            border: none;
        }

        .back-btn {
            margin-top: 20px;
            padding: 10px;
            background: #2196f3;
            color: white;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <div class="header">
        <div>Por√≥wnania</div>
        <div class="theme-btn" id="themeToggle">üåô</div>
    </div>

    <!-- STRONA G≈Å√ìWNA -->
    <div id="homeScreen" class="container">
        <div id="comparisonList"></div>
        <button class="add-btn" onclick="newComparison()">+</button>
    </div>

    <!-- EKRAN POR√ìWNANIA -->
    <div id="editScreen" class="container hidden">
        <input id="titleInput" placeholder="Tytu≈Ç por√≥wnania">

        <div class="section-title">Plusy</div>
        <div id="plusList"></div>
        <input id="plusText" placeholder="Dodaj plus">
        <select id="plusWeight">
            <option value="1">1</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5</option>
        </select>
        <button onclick="addPlus()">Dodaj plus</button>

        <div class="section-title">Minusy</div>
        <div id="minusList"></div>
        <input id="minusText" placeholder="Dodaj minus">
        <select id="minusWeight">
            <option value="1">1</option><option value="2">2</option>
            <option value="3">3</option><option value="4">4</option>
            <option value="5">5</option>
        </select>
        <button onclick="addMinus()">Dodaj minus</button>

        <div id="scoreBox" class="score-box">Wynik: -</div>

        <div class="back-btn" onclick="goHome()">Zapisz i wr√≥ƒá</div>
    </div>

<script>
let comparisons = JSON.parse(localStorage.getItem("comparisons") || "[]");
let currentId = null;

/* ---------------- HOME SCREEN ---------------- */

function renderHome() {
    let list = document.getElementById("comparisonList");
    list.innerHTML = "";

    comparisons.forEach((c, i) => {
        let div = document.createElement("div");
        div.className = "comparison-card";
        div.innerHTML = `<strong>${c.title || "Bez tytu≈Çu"}</strong><br>
                         Wynik: ${calculateScore(c).toFixed(2)}`;
        div.onclick = () => openComparison(i);
        list.appendChild(div);
    });
}

function newComparison() {
    currentId = comparisons.length;
    comparisons.push({ title: "", plus: [], minus: [] });
    openComparison(currentId);
}

/* ---------------- EDIT SCREEN ---------------- */

function openComparison(id) {
    currentId = id;
    document.getElementById("homeScreen").classList.add("hidden");
    document.getElementById("editScreen").classList.remove("hidden");

    let data = comparisons[id];

    document.getElementById("titleInput").value = data.title;

    renderItems();
    updateScore();
}

function goHome() {
    let data = comparisons[currentId];
    data.title = document.getElementById("titleInput").value;

    localStorage.setItem("comparisons", JSON.stringify(comparisons));

    document.getElementById("editScreen").classList.add("hidden");
    document.getElementById("homeScreen").classList.remove("hidden");

    renderHome();
}

/* ---------------- LISTY PLUS√ìW / MINUS√ìW ---------------- */

function renderItems() {
    let plusList = document.getElementById("plusList");
    let minusList = document.getElementById("minusList");

    let data = comparisons[currentId];

    plusList.innerHTML = "";
    minusList.innerHTML = "";

    data.plus.forEach((item, i) => {
        plusList.innerHTML += `
            <div class="item-row">
                <div>+ ${item.text} (waga: ${item.w})</div>
                <button class="delete-btn" onclick="deletePlus(${i})">X</button>
            </div>`;
    });

    data.minus.forEach((item, i) => {
        minusList.innerHTML += `
            <div class="item-row">
                <div>- ${item.text} (waga: ${item.w})</div>
                <button class="delete-btn" onclick="deleteMinus(${i})">X</button>
            </div>`;
    });
}

function addPlus() {
    let text = document.getElementById("plusText").value;
    let w = Number(document.getElementById("plusWeight").value);

    if (!text) return;

    comparisons[currentId].plus.push({ text, w });
    document.getElementById("plusText").value = "";

    renderItems();
    updateScore();
}

function addMinus() {
    let text = document.getElementById("minusText").value;
    let w = Number(document.getElementById("minusWeight").value);

    if (!text) return;

    comparisons[currentId].minus.push({ text, w });
    document.getElementById("minusText").value = "";

    renderItems();
    updateScore();
}

function deletePlus(i) {
    comparisons[currentId].plus.splice(i, 1);
    renderItems();
    updateScore();
}

function deleteMinus(i) {
    comparisons[currentId].minus.splice(i, 1);
    renderItems();
    updateScore();
}

/* ---------------- OBLICZANIE WYNIKU ---------------- */

function calculateScore(c) {
    let plus = c.plus.reduce((a, b) => a + b.w, 0);
    let minus = c.minus.reduce((a, b) => a + b.w, 0);

    let max = Math.max(1, plus + minus);
    return (plus / max) * 5;
}

/* ---------------- SKALA KOLOR√ìW ---------------- */

function getColorForScore(score) {
    if (score <= 1) return "#ff2e2e";
    if (score <= 2) return "#ff7a00";
    if (score < 2.5) return "#ffd700";
    if (score === 2.5) return "#9e9e9e"; // remis
    if (score < 3) return "#a6ff4d";
    if (score <= 4) return "#32cd32";
    return "#008000";
}

function updateScore() {
    let score = calculateScore(comparisons[currentId]);
    let box = document.getElementById("scoreBox");
    box.innerHTML = "Wynik: " + score.toFixed(2);
    box.style.background = getColorForScore(score);
}

/* ---------------- MOTYW ---------------- */

let isDark = false;

document.getElementById("themeToggle").onclick = () => {
    isDark = !isDark;
    document.body.classList.toggle("dark", isDark);
    document.getElementById("themeToggle").textContent = isDark ? "‚òÄÔ∏è" : "üåô";
};

/* ---------------- START ---------------- */
renderHome();
</script>

</body>
</html>
